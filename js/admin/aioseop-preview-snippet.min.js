var snippetTitle="",snippetDescription="",aioseopTitle="",aioseopDescription="",docTitle="",isGutenberg=aioseop_preview_snippet.isGutenberg,autogenerateDescriptions=aioseop_preview_snippet.autogenerateDescriptions,skipExcerpt=aioseop_preview_snippet.skipExcerpt;function aioseopUpdateMetabox(){snippetTitle=$("#aiosp_snippet_title"),snippetDescription=$("#aioseop_snippet_description"),aioseopTitle=$('input[name="aiosp_title"]'),aioseopDescription=$('textarea[name="aiosp_description"]'),"false"===isGutenberg?aioseopUpdateMetaboxClassicEditor():aioseopUpdateMetaboxGutenbergEditor(),aioseopTitle.on("input",function(){aioseopChangeSnippet(snippetTitle,aioseopTitle),""===aioseopTitle.val()&&aioseopChangeSnippet(snippetTitle,docTitle)})}function aioseopUpdateMetaboxClassicEditor(){docTitle=$("#title");var i=$("#excerpt");function e(){if(""===aioseopDescription.val()&&"on"===autogenerateDescriptions){if("on"!==skipExcerpt&&""!==i.val())return aioseopChangeSnippet(snippetDescription,i),void aioseopChangePlaceholder(aioseopDescription,i);var e=aioseopGetDescription();snippetDescription.text(e),aioseopDescription.attr("placeholder",e)}}docTitle.on("input",function(){aioseopChangePlaceholder(aioseopTitle,docTitle),""===aioseopTitle.val()&&aioseopChangeSnippet(snippetTitle,docTitle)}),aioseopDescription.on("input",function(){aioseopChangeSnippet(snippetDescription,aioseopDescription),e()}),i.on("input",function(){e()}),setTimeout(function(){tinymce.editors[0].on("KeyUp",function(){e()})},1e3)}function aioseopUpdateMetaboxGutenbergEditor(){function e(){if(""===aioseopDescription.val()&&"on"===autogenerateDescriptions){var e=wp.data.select("core/editor").getEditedPostAttribute("excerpt");if("on"!==skipExcerpt&&""!==e)return snippetDescription.text(e.replace(/<(?:.|\n)*?>/gm,"")),void snippetDescription.attr("placeholder",e);var i=aioseopGetDescription();snippetDescription.text(i),aioseopDescription.attr("placeholder",i)}}window._wpLoadBlockEditor.then(function(){setTimeout(function(){(docTitle=$("#post-title-0")).on("input",function(){aioseopChangePlaceholder(aioseopTitle,docTitle),""===aioseopTitle.val()&&aioseopChangeSnippet(snippetTitle,docTitle)}),aioseopDescription.on("input",function(){aioseopChangeSnippet(snippetDescription,aioseopDescription),e()}),wp.data.subscribe(function(){e()})})})}function aioseopChangeSnippet(e,i){e.text(i.val().replace(/<(?:.|\n)*?>/gm,""))}function aioseopChangePlaceholder(e,i){e.attr("placeholder",i.val())}function aioseopGetDescription(){return aioseopDecodeHtmlEntities(aioseopStripEditorMarkup("false"===isGutenberg?$("#content_ifr").contents().find("body")[0].innerHTML:wp.data.select("core/editor").getEditedPostAttribute("content")).replace(/^(.{165}[^\s]*).*/,"$1"))}function aioseopStripEditorMarkup(e){return e.replace(/<[^>]*>?/gm,"").replace(/\s\s+/g," ").trim()}function aioseopDecodeHtmlEntities(e){var i=document.createElement("textarea");return i.innerHTML=e,i.value}$(document).ready(function(){aioseopUpdateMetabox()});